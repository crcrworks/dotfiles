# Plan: oh-my-opencode Planner-SisyphusでQuestionツールを使用可能にする

## 調査結果

### 問題の根本原因
OpenCode v1.1.19の`question`ツールには**2つの制限**がある：

1. **CLIクライアント専用**: `question`ツールは`OPENCODE_CLIENT === "cli"`の時のみ登録される
   ```typescript
   // packages/opencode/src/tool/registry.ts
   ...(Flag.OPENCODE_CLIENT === "cli" ? [QuestionTool] : [])
   ```

2. **サブエージェントでは利用不可（設計上の制限）**: 
   - サブエージェント（Task経由で起動されるエージェント）は親セッションとは別のコンテキストで動作
   - サブエージェントがユーザーに質問を表示する仕組みが存在しない（GitHub issue #4078参照）

### Planner-Sisyphus (Prometheus) の状況
oh-my-opencodeの`Prometheus (Planner)`は**サブエージェント**として動作するため、`question`ツールが使用できない。

oh-my-opencode内部では`PROMETHEUS_PERMISSION`に`question: "allow"`が設定されているが、サブエージェントとして呼び出される限りツール自体が利用不可。

## 解決策

### Option A: Prometheusをプライマリエージェントとして使用（推奨）
`sisyphus_agent.replace_plan: false`を設定し、**元のplanエージェント（プライマリ）を使う**。
プライマリエージェントでは`question`ツールが使用可能。

### Option B: Tabキーでプライマリエージェントに切り替え
Planner作業が必要な時は、Tabキーで`plan`や`Prometheus (Planner)`プライマリエージェントに切り替える。

### Option C: oh-my-opencode側の対応を待つ
この制限はOpenCode本体の設計によるもの。oh-my-opencodeやOpenCode本体でサブエージェントからの質問をサポートする機能が追加されるまで待つ。

## 推奨アクション

現在の`oh-my-opencode.json`は既に`replace_plan: false`が設定済みなので、
**元の`plan`エージェント（プライマリ）を使用すれば`question`ツールが利用可能**。

### 使用方法
1. OpenCodeを起動
2. **Tabキー**を押して`plan`エージェントに切り替え
3. `plan`エージェントでは`question`ツールが使用可能

## 補足
- `Prometheus (Planner)`はサブエージェントとして設計されており、@メンションやTask経由で呼び出される
- プライマリエージェントとして動作するplanエージェントとは別物
- v1.1.19でサブエージェントの権限表示問題（#4078）は報告されているが、未解決
